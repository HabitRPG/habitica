nav.toolbar(ng-controller='AuthCtrl')
  ul.toolbar-mobile-nav
    li.toolbar-mobile
      a(ng-click='expandMenu("mobile")', ng-class='{active: _expandedMenu=="mobile"}')
        span  &#9776;
      div(ng-if='_expandedMenu=="mobile"', ng-click='expandMenu(null)')
        h4=env.t('menu')
        .glyphicon.glyphicon-check
        ul.toolbar-submenu
          li
            a(ui-sref='tasks')=env.t('tasks')
        .glyphicon.glyphicon-user
        ul.toolbar-submenu
          li
            a(ui-sref='options.profile.avatar')=env.t('avatar')
          li
            a(ui-sref='options.profile.stats')=env.t('stats')
          li
            a(ui-sref='options.profile.profile')=env.t('profile')
        .glyphicon.glyphicon-heart
        ul.toolbar-submenu
          li
            a(ui-sref='options.social.tavern')=env.t('tavern')
          li
            a(ui-sref='options.social.party')=env.t('party')
          li
            a(ui-sref='options.social.guilds')=env.t('guilds')
          li
            a(ui-sref='options.social.challenges')=env.t('challenges')
          li
            a(ui-sref='options.social.hall')=env.t('hall')
        .glyphicon.glyphicon-gift
        ul.toolbar-submenu
          li
            a(ui-sref='options.inventory.drops')=env.t('market')
          li
            a(ui-sref='options.inventory.pets')=env.t('pets')
          li
            a(ui-sref='options.inventory.mounts')=env.t('mounts')
          li
            a(ui-sref='options.inventory.equipment')=env.t('equipment')
        ul.toolbar-controls
          li
            a(ng-click='expandMenu(null)')=env.t('close')
  ul.toolbar-nav
    li.toolbar-button
      a(ui-sref='tasks')
        span=env.t('tasks')
    li.toolbar-button-dropdown
      a(ui-sref='options.profile.avatar')
        span=env.t('user')
      a(ng-click='expandMenu("avatar")', ng-class='{active: _expandedMenu == "avatar"}')
        span &#9776;
      div(ng-if='_expandedMenu == "avatar"')
        ul.toolbar-submenu(ng-click='expandMenu(null)')
          li
            a(ui-sref='options.profile.avatar')=env.t('avatar')
          li
            a(ui-sref='options.profile.stats')=env.t('stats')
          li
            a(ui-sref='options.profile.profile')=env.t('profile') 
    li.toolbar-button-dropdown
      a(ui-sref='options.social.tavern')
        span=env.t('social')
      a(ng-click='expandMenu("social")', ng-class='{active: _expandedMenu == "social"}')
        span &#9776;
      div(ng-if='_expandedMenu == "social"')
        ul.toolbar-submenu(ng-click='expandMenu(null)')
          li
            a(ui-sref='options.social.tavern')=env.t('tavern')
          li
            a(ui-sref='options.social.party')=env.t('party')
          li
            a(ui-sref='options.social.guilds')=env.t('guilds')
          li
            a(ui-sref='options.social.challenges')=env.t('challenges')
          li
            a(ui-sref='options.social.hall')=env.t('hall')
    li.toolbar-button-dropdown
      a(ui-sref='options.inventory.drops')
        span=env.t('inventory')
      a(ng-click='expandMenu("inventory")', ng-class='{active: _expandedMenu == "inventory"}')
        span  &#9776;
      div(ng-if='_expandedMenu == "inventory"')
        ul.toolbar-submenu(ng-click='expandMenu(null)')
          li
            a(ui-sref='options.inventory.drops')=env.t('market')
          li
            a(ui-sref='options.inventory.pets')=env.t('pets')
          li
            a(ui-sref='options.inventory.mounts')=env.t('mounts')
          li
            a(ui-sref='options.inventory.equipment')=env.t('equipment')
  ul.toolbar-subscribe  
    li
      button(ng-if='!user.purchased.plan.customerId',ui-sref='options.settings.subscription',popover-trigger='mouseenter',popover-placement='bottom',popover-title=env.t('subscriptions'),popover=env.t('subDescription'),popover-append-to-body='true')=env.t('subscribe')
  ul.toolbar-options  
    li.toolbar-notifs
      a(ng-click='expandMenu("notifs")')
        span.glyphicon.glyphicon-comment(ng-if='!user.invitations.party.id && !user.purchased.plan.mysteryItems.length && user.invitations.guilds.length === 0', ng-class='{inactive: _.isEmpty(user.newMessages)}')
        span.glyphicon.glyphicon-user(ng-if='!user.purchased.plan.mysteryItems.length && (user.invitations.party.id || user.invitations.guilds.length > 0)')
        span.glyphicon.glyphicon-gift(ng-if='user.purchased.plan.mysteryItems.length')
      div(ng-if='_expandedMenu=="notifs"')
        h4=env.t('notifications')
        ul.toolbar-notifs-notifs
          li(ng-if='!user.invitations.party.id && !user.purchased.plan.mysteryItems.length && user.invitations.guilds.length === 0 && _.isEmpty(user.newMessages)')
            | You have no new messages.
          li(ng-if='user.purchased.plan.mysteryItems.length')
            a(ng-click='$state.go("options.inventory.drops"); expandMenu(null)')
              span.glyphicon.glyphicon-gift
              span=env.t('newSubscriberItem')
          li(ng-if='user.invitations.party.id')
            a(ui-sref='options.social.party', ng-click='expandMenu(null)')
              span.glyphicon.glyphicon-user
              span=env.t('invitedTo', {name: '{{user.invitations.party.name}}'})
          li(ng-repeat='guild in user.invitations.guilds')
            a(ui-sref='options.social.guilds', ng-click='expandMenu(null)')
              span.glyphicon.glyphicon-user
              span=env.t('invitedTo', {name: '{{guild.name}}'})
          li(ng-repeat='(k,v) in user.newMessages', ng-if='v.value')
            a(ng-click='k==party._id ? $state.go("options.social.party") : $state.go("options.social.guilds.detail",{gid:k}); expandMenu(null)')
              span.glyphicon.glyphicon-comment
              span {{v.name}}
            a(ng-click='Groups.seenMessage(k)', popover=env.t('clear'),popover-placement='right',popover-trigger='mouseenter',popover-append-to-body='true')
              span.glyphicon.glyphicon-remove-circle
        ul.toolbar-controls
          //-li
            //-a(ng-click='') Clear all
          li
            a(ng-click='expandMenu(null)')=env.t('close')
    li.toolbar-sync
      a(ng-click='User.sync()', popover=env.t('sync'),popover-placement='bottom',popover-trigger='mouseenter')
        span.glyphicon.glyphicon-refresh
    li.toolbar-settings
      a(ng-click='expandMenu("settings")')
        span.glyphicon.glyphicon-cog
      div(ng-if='_expandedMenu=="settings"')
        h4=env.t('settings')
        ul(ng-click='expandMenu(null)')
          li
            a(ng-click='logout()')=env.t('logout')
          li
            a(ui-sref='options.settings.settings')=env.t('site')
          li
            a(ui-sref='options.settings.api')=env.t('API')
          li
            a(ui-sref='options.settings.export')=env.t('export')
          li
            a(ui-sref='options.settings.coupon') Coupon
          li
            a(ui-sref='options.settings.subscription')=env.t('subscription')
          li
            a(href="http://habitrpg.wikia.com/wiki/FAQ", target='_blank')=env.t('FAQ')
          li
            a(href="https://vimeo.com/57654086", target='_blank')=env.t('tutorials')
        ul.toolbar-controls
          li
            a(ng-click='expandMenu(null)')=env.t('close')
  ul.toolbar-wallet
    li.toolbar-gems
      a.gem-wallet(ng-click='openModal("buyGems",{track:"Gems > Toolbar"})', popover-trigger='mouseenter', popover-title=env.t('gems'), popover=env.t('gemsWhatFor'), popover-placement='bottom',popover-append-to-body='true')
        //-span.task-action-btn.tile.flush.bright.add-gems-btn ï¼‹
        span.Pet_Currency_Gem2x.Gems
        span.gem-text {{user.balance * 4 | number:0}}
    li.toolbar-currency.gold(popover=env.t('gold'), popover-placement='bottom',popover-trigger='mouseenter')
      span.shop_gold
      span {{Shared.gold(user.stats.gp) | goldRoundThousandsToK}}
    li.toolbar-currency.silver(popover=env.t('silver'), popover-placement='bottom',popover-trigger='mouseenter')
      span.shop_silver
      span {{Shared.silver(user.stats.gp)}}
  ul.toolbar-bailey(ng-class='{inactive: !_expandedMenu}')
    li.toolbar-bailey-container(ng-if='user.flags.newStuff')
      .npc_bailey.npc_bailey_head(popover=env.t('psst'), popover-trigger='mouseenter', popover-placement='right', ng-click='openModal("newStuff")')